\assignementTitle{Задача 5. Посади электродерево}{37}{}

Внимание! Эта задача весьма сложна, поэтому беритесь за неё, только если очень сильно уверены в том, что её решите, или после того, как решите остальные задачи.

В вашем распоряжении имеется энергосистема из генераторов и потребителей, объединённых в сеть топологии «дерево».

Мощность потребления/генерации каждого потребителя известена (она находится в пределах от -1 до 1).

Известен коэффициент потерь на каждой линии, соединяющей объекты энергосистемы, R (от 0.01 до 0.02).

Потери на линии можно вычислить по формуле: Q=P2×R, где P — мощность, передаваемая по линии, а R — коэффициент её потерь.

\putImgWOCaption{12cm}{1}

Энергосистема не сбалансирована (потребление не равно генерации), и вы выбираете место для подключения сети к внешней энергосистеме для её балансировки. Его нужно выбрать так, чтобы суммарные потери электроэнергии в энергосистеме стали минимальными.

\inputfmtSection

Дерево, представленное списками вершин (узлов) и рёбер (линий).

Для каждого списка сначала приводится его длина, затем элементы на отдельных строках.

Каждый узел представлен номером и потреблением, записанными через пробел.

Каждая линия — двумя номерами узлов и сопротивлением, также записанными через пробел.

Все элементы нумеруются с единицы, а не c нуля.

\outputfmtSection

Число — номер узла, в котором нужно установить подключение к внешней энергосистеме.

\sampleTitle{1}

\begin{myverbbox}[\small]{\vinput}
    20
    1 0.024163778035099635
    2 0.19565699001037376
    3 -0.7637821782044889
    4 -0.028226916356001587
    5 0.8697284181820586
    6 0.3733013894822612
    7 0.6840817064112741
    8 -0.6131926407131862
    9 0.48967147884270656
    10 -0.15099795336447938
    11 0.2811479872131111
    12 -0.26269659300009707
    13 0.5398361561230487
    14 -0.882166220101082
    15 0.42636847196784555
    16 0.14358218753248633
    17 -0.6419599456437441
    18 0.27050898163756587
    19 -0.17770902338537795
    20 -0.7773160746693744
    19
    1 2 0.01535068537697453
    2 3 0.019389261888600864
    2 4 0.014736532285625591
    4 5 0.01790151673588955
    1 6 0.01161291996565344
    4 7 0.013004263512249842
    5 8 0.011458276350586605
    4 9 0.015554695564785236
    3 10 0.01329141854582266
    9 11 0.01567961098227486
    3 12 0.018451984551052913
    3 13 0.01511693727529641
    3 14 0.01123448474818787
    2 15 0.014035505859012452
    10 16 0.016065517014648877
    10 17 0.011598946777423888
    12 18 0.013050336805736836
    15 19 0.01904939072374451
    10 20 0.01097086560277972
\end{myverbbox}
\begin{myverbbox}[\small]{\voutput}
    11
\end{myverbbox}
\inputoutputTable

\solutionSection

Перебираются все варианты установки подключения, для каждого вычисляются потери в энергосистеме. Потери вычисляются свёрткой дерева к корню — рассматриваемой вершине. Свёртка листа происходит следующим образом: вычисляются потери от передачи энергии от листа к вышестоящему узлу (передаваться может и отрицательное значение). Модуль передаваемой мощности уменьшается на это число, после чего оставшаяся мощность добавляется к значению вышестоящей вершины. Потери добавляются к общим потерям, лист удаляется.

\includeSolutionIfExistsByPath{final/subject_tour/inf1503_ies/task_05}
