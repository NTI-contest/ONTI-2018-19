Пришло время интегрировать спутник, полезную нагрузку и СУПН. Следуйте следующему алгоритму действий:

\begin{enumerate}
    \item Настройте беспроводную передачу данных с Raspberry
    \item Соедините оптику и камеру
    \item Соедините Raspberry и спутник
    \item Присоедините к корпусу спутника оптическую систему
    \item Допишите алгоритм ориентации так, чтобы при повороте на заданный градус спутник передавал фото на ваш ПК
\end{enumerate}

\subsubsection*{Настройка беспроводной сети Raspberry}

Для настройки беспроводного подключения можно использовать несколько вариантов:

\begin{enumerate}
    \item Использовать беспроводную сеть, которую раздает БКУ вашего аппарата. В этом случае в вашей сети будет 3 устройства - БКУ, ЦУП и СУПН.
    \item Этот способ наиболее предпочтителен, так как все устройства находятся в одной подсети.
    \item Использовать сеть RS для беспроводного подключения СУПН. Этот способ не автономен и требует постоянного присутствия внешней сети. Также, многие компьютеры не способны одновременно подключиться к нескольким беспроводным сетям. По запросу мы можем фиксировать автоматически выдаваемый адрес устройства на роутере. Этот способ удобен для настройки СУПН, однако после настройки конфигурации попытайтесь перейти к способу №1.
    \item Вы создаете собственную локальную подсеть с помощью компьютера или мобильного устройства. Этот способ так-же не автономен. Кроме того, многие компьютеры не способны одновременно подключаться к сети БКУ и отдельной сети, в которой будет ваша  СУПН. Этот способ возможно использовать как промежуточное решение, перейдя в последствии к способу №1.
    \item СУПН может раздавать собственную беспроводную сеть, к которой подключится ЦУП. Этот способ возможен, однако не рекомендуется в виду нестабильной работы. Также, вы вероятно не сможете одновременно управлять БКУ и СУПН из ЦУП.
\end{enumerate}

\subsubsection*{Интеграция оптики и СУПН}

Получите фото с Raspberry, и передайте его на свой ПК.

Ваша задача сохранять изображения, полученные камерой с системой оптических элементов в памяти СУПН, и далее передавать их на компьютер с которого осуществляется управление БКУ (ЦУП). При сохранении файлов используйте уникальный идентификатор вашей команды (номер или буквенно-цифровой шифр) а также уникальный идентификатор снимка (дату и время или буквенно-цифровой шифр в описанном вами формате). 

Полученные изображения должны быть отравлены в реальном времени на управляющий БКУ компьютер, с использованием стандартных сетевых протоколов (HTTP, UDP, FTP, SFTP, и других)

\subsubsection*{Интеграция СУПН и спутника}

Подключите Raspberry к бортовой сети спутника. Ваша задача  - делать снимки камерой, подключенной к модулю СУПН по команде от управляющей программы БКУ. Также, при сохранении снимков в названии файлов нужно использовать уникальный идентификатор, получаемый от БКУ.  

Эту задачу возможно сделать несколькими способами:

\textit{Способ 1.} Настройте обмен данными между спутником и Raspberry через Arduino: 
Например, можно использовать подключение Arduino к сети спутника через переходной шилд, а подключение Arduino к Raspberry осуществить через USB.

Подключите к сети спутника Arduino, используя инструкцию:\\ \url{http://www.orbicraft.sputnix.ru/doku.php?id=arduino_module_base_lesson}.

При подключении Arduino и Raspberry использовать Serial на Arduino и ttyUSB0 со стороны Raspberry, чтобы получать данные на Raspberry с Arduino. О том, как это можно сделать примерно описано здесь: \url{https://arduinoplus.ru/podkluchenie-raspberry-arduino/}

\textit{Способ 2.} Попробуйте напрямую подключить свою Raspberry к БКУ используя шнур конвертор шины rs485 - USB (как правило ttyUSB0 со стороны Raspberry) с дополнительным питанием для Raspberry от шины спутника. В этом случае разбор протокола обмена данными в бортовой шине аппарата ложится на Raspberry. Для разбора протокола шины спутника используйте примеры и исходные коды библиотек с сайта: \url{http://www.orbicraft.sputnix.ru/doku.php?id=arduino_module_base_lesson}

\subsubsection*{Полная интеграция}

Полная интеграция включает в себя сборку компонентов в единую систему и выстраивание циклограммы работы космического аппарата. Необходимо:

\begin{itemize}
    \item прикрепить оптическую систему к КА
    \item включить в бортовую систему КА СУПН, при этом камера должна быть как элементом оптической системы, так и управляться Raspberry
    \item выстроить работу КА
\end{itemize}

\underline{Монтаж оптической системы}

Необходимо прикрепить собранную оптическую систему к спутнику. Для этого у вас есть крепления для трубы (пара хомутов), которые можно прикрепить к спутнику. При креплении оптики к вашему спутнику учтите тонкости весовой балансировки.

Учтите, что есть возможность изготовить детали путём лазерной резки и 3д-печати. Уточняйте у организаторов по поводу того, как это сделать.

\underline{Циклограмма работы КА}

\begin{enumerate}
    \item Уже в полной сборке ваш спутник должен уметь ориентироваться на заданный угол. Для этого вам необходимо будет поправить уже имеющийся у вас код ориентации.
    \item В вашей программе управления спутником после выполнения ориентации СУПН должна получать снимок. Для этого вам необходимо доработать обмен данными БКУ и Raspberry, а также интегрировать сюда ваше решение по автоматизированному получению снимка.
    \item После того, как СУПН сделает снимок, она должна передать его на ЦУП. В роли ЦУПа выступает ваш ПК.
\end{enumerate} 

Итогом выполнения программы управления вашим устройствов должен стать снимок объекта, на который наводится ваш КА. Снимок должен быть передан на ЦУП.

\subsubsection*{Проектирование группировки}

Разработка проекта созвездия в происходит в симуляторе «Орбита» и включает задачи:

\begin{enumerate}
    \item Осуществить обзорную съемку всей зоны интереса с наименьшем временным диапазоном и минимальной стоимостью группировки
    \item Осуществить съемку максимальной доли зоны интереса с наилучшим пространственном разрешением и минимальной стоимостью группировки
\end{enumerate}

Сегодня становится доступна вторая задача в симуляторе. Отличие от предыдущей в том, что необходимо снять узлы прохода с максимально хорошим разрешением. Покрытие зоны при этом ограничено набором зон интереса, координаты которых указаны в условии.

\assignementTitle{}{35}{}

Используя до 10 аппаратов с камерами для детального наблюдения, обеспечьте максимальное покрытие указанной зоны с наилучшим качеством по наименьшей цене при съемке в видимом диапазоне.
Зона съемки: области (широта-широта и долгота-долгота):

\begin{itemize}
    \item 68-69, 73-74
    \item 70-71, 73-74
    \item 73-74, 70-72
    \item 71-72, 64-65
    \item 70-71, 57-59
    \item 70-71, 48-49
    \item 69-70, 43-44
    \item 69-70, 37-38
    \item 68-69, 33-35
\end{itemize}

Определение “узлов” зоны: Зона разбивается по широте с севера на юг на полосы шириной 1 км, остаток отбрасывается. Дальше каждая полоса разбивается по долготе с запада на восток на ячейки 1 $\times$ 1 км, остаток отбрасывается. Назовем “узлом” центр каждой такой ячейки. Узел считается снятым, если след аппарата в надире прошел от него не далее, чем на расстоянии половины ширины полосы съемки. “Вес” узла = $1/N$, где $N$ - количество узлов в зоне интереса.

Подзадачи:

\begin{itemize}
    \item Снять не менее одного раза в сутки указанную зону с ПР не более 20 м.
    \item Снять не менее одного раза в сутки указанную зону с ПР не более 10 м.
    \item Снять не менее одного раза в сутки указанную зону с ПР не более 3 м.
    \item Снять указанную зону от 2 до 6 раз за время симуляции с ПР не более 20 м.
    \item Старт работы КА на орбите начинается с 01 июня 2019 года с 00:00 по UTC. Первые три часа пролёта не учитываются.
\end{itemize}

Примечание: Период начисления баллов с 01.06.2019 03:00 по 03.06.2019 03:00 по времени симуляции.

\markSection

\begin{itemize}
    \item Первая за двое суток съемка узла с разрешением съемки не более 20 м: 10 баллов $\times$ (вес узла).
    \item Первая за двое суток съемка узла с разрешением съемки не более 10 м: 20 баллов $\times$ (вес узла).
    \item Первая за двое суток съемка узла с разрешением съемки не более 3 м: 30 баллов $\times$ (вес узла).
    \item Съемка узла от двух до шести раз за время симуляции с разрешением не более 20 м: 4 балла $\times$ (вес узла) (за каждое).
\end{itemize}

\textit{Общие критерии оценки:}

\begin{itemize}
    \item Проход над точкой менее, чем через 60 минут после предыдущего, не засчитывается.
    \item При условной стоимости группировки S свыше 10 единиц результат домножается на коэффициент 10/S.
    \item При снижении аппарата на высоту 300 км и менее балы перестают начисляться.
    \item Итоговая сумма баллов за задачу округляется до одного знака после запятой.
    \item Оценка за задачу равна сумме оценок за подзадачи.
\end{itemize}

Максимальное количество баллов: 80.

Балл за первую задачу идет в зачет второго дня. Балл за вторую - в зачет этого дня. Балл, полученный за решение задачи в симуляторе суммируется с баллами, полученными вами по листу критериев оценки.

\subsubsection*{Сохранение результатов}

Крайне важно сохранить результаты работы дня на сервере в папке day01.

\begin{enumerate}
    \item[0.] Нам важно понимать, как именно вы решаете задачу, поэтому записывайте команды, которые используете при работе с распберри в отдельный файл.
    \item[0.a)] Простой вариант. В любом виде и порядке записывайте команды в обычный doc или txt файл. 
    \item[0.б)] Создайте bash-файл по каждому заданию. Например:
    
    sudo touch algo.sh\\
    vim algo.sh \\
    Далее вам откроется окно текстового редактора vim. для удобства открывайте его в отдельном окне терминала. 
    
    Файл нужно начать со строки \\
    \#!bash \\
    Попробуйте записывать в этот файл команды, которые вы использовали для решения задания. Например при подключении к raspberry с компьютера на линуксе можно создать такой файл:  
    \#!bash\\ 
    ifconfig    \\
    sudo nmap -sn 10.42.0.0/24\\
    sudo ssh pi@10.42.0.55\\
    Также, стоит сохранить финальные скетчи программ для Arduino и программы выполняемые на Raspberry. Сопроводите их минимальным описанием ожидаемой логики работы, в текстовом файле readme.txt
    \item[1.] Загрузите фото собранного спутника
    \item[2.] Загрузите описание алгоритма работы с Raspberry, касающегося получения и передачи фото на ПК
    \item[3.] Загрузите финальный рабочий код работы спутника 
    \item[4.] Не забудьте также загрузить финальный снимок, полученный с КА
\end{enumerate} 

\markSection

\begin{table}[H]
    \center
    \begin{tabular}{|p{7cm}|c|c|}
        \hline
        Задача & Макс. балл & Балл команды \\
        \hline
        \multicolumn{3}{|c|} {Спутник} \\
        \hline
        Стабилизация: спутник в состоянии погасить начальную закрутку и продержаться в стабильном состоянии 40 секунд & 5 & \\
        \hline
        Ориентация: спутник способен повернуться на заданный угол и удерживать своё положение не менее 40 секунд & 10 & \\
        \hline
        \multicolumn{3}{|c|}{СУПН} \\
        \hline
        Настроено беспроводное соединение & 5 & \\
        \hline
        Фото сохраняется на ваш ПК в автоматизированном режиме & 10 & \\
        \hline
        \multicolumn{3}{|c|}{Интеграция СУПН и спутника}\\
        \hline
        Настроен обмен данными между Raspberry и БКУ & 15 & \\
        \hline
        По сигналу от БКУ Raspberry делает фото и передаёт его на ПК & 25 & \\
        \hline
        \multicolumn{3}{|c|}{Полная интеграция}\\
        \hline
        Осуществлена полная сборка компонентов, компоненты запитаны и находятся в работоспособном состоянии & 15 & \\
        \hline 
        Решение комплексной задачи: 
        \begin{itemize}
            \item спутник ориентируется с оптической системой на заданный угол
            \item после ориентации спутник делает снимок
            \item снимок передаётся на ПК
            \item полученный снимок не является размытым
        \end{itemize} & 50 & \\
        \hline
    \end{tabular}
\end{table}