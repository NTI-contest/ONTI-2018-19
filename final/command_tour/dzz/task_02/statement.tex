Сегодняшний день в большей степени посвящён работе с полезной нагрузкой: необходимо собрать и провести первичную настройку оптической системы, а также научиться получать с неё снимки. Но не стоит забывать и про базовые задачи, которую должна решать спутниковая платформа. В этот день у вас добавляется также задача по моделированию группировки.

\subsubsection*{Спутник}

Первоначально доведите до конца задачу по стабилизации. Далее переходите к задаче ориентации. Как соориентировать спутник описано здесь: \url{http://www.orbicraft.sputnix.ru/doku.php?id=lesson7}

Цель: иметь работоспособный алгоритм, который потом можно будет быстро подправить при изменении сборки КА.

\subsubsection*{Оптика}

Необходимо из оптических элементов осуществить сборку оптической системы. В основе оптической системы лежит схема Кассегрена-Максутова, в которой присутствует два оптических элемента (см. рисунок)

\putImgWOCaption{12cm}{1}

Такая схема используется в малых космических аппаратах (МКА), так как система зеркал позволяет значительно увеличить фокусное расстояние при сохранении небольших размеров. Однако возможна также сборка без мениска. В этом случае ваше изображение будет фокусироваться перед главным зеркалом.

Для сборки вам уже даны необходимые детали. Однако для того, чтобы закрепить камеру и иметь возможность получать четкое изображение, необходимо подобрать её фокусное расстояние. Для этого следуйте инструкции.

\subsubsection*{Сборка телескопа}

\begin{enumerate}
    \item Посмотреть все детали и проверить что всё на месте. В комплекте должны быть:
    \begin{enumerate}
        \item[а)] вогнутое зеркало с отверстием посредине
        \item[б)] выпукло-вогнутая линза (мениск) с напылением посредине
        \item[в)] труба серая основная 
        \item[г)] труба главного зеркала: чёрная труба и задней стенкой, в задней стенке круглое отверстие по центру и три пары по равностороннему треугольнику
        \item[д)] опора для главного зеркала - диск с отверстиями почти такими же как в держателе зеркала, кроме трёх маленьких круглых по треугольнику и резьбой, и закрывашка для главного зеркала - кольцо с резьбой которая подходит к резьбе опоры.
        \item[е)] труба для мениска - чёрная труба с внутренней резьбой
        \item[ё)] держатель для мениска - кольцо с наружной резьбой
        \item[ж)] линейный переместитель (транслятор) - две чёрные детали которые как по рельсам ходят друг по другу, с хомутом для крепления камеры
    \end{enumerate}
    \item Вставить мениск в трубу для мениска и накрутить держатель. Мениск должен быть обращён своей выпуклой стороной к главному зеркалу. На мениске есть бленда - светозащитная перегородка которая не пускает паразитный свет. Вставить трубу мениска в основную трубу.
    \item Вставить болты в 3 отверстия опору главного зеркала, шляпка болта должна находиться внутри стенок опоры. Надеть пружинки на болты. Надеть трубу главного зеркала. Должно получится так, что 3 пружинки зажаты между двумя деталями. Затянуть детали болтами, но не до упора.
    \item Закрутить три винта в круглые отверстия трубы по треугольнику, чтобы они давили на опору главного зеркала. Этими тремя винтами будет производиться юстировка главного зеркала
    \item Вставить трубу главного зеркала в основную серую трубу 
    \item Вставить  длинный  болт в части линейного переместителя. Прикрутить винтами хомут для камеры. Вставить выступ линейного переместителя в соотвующее отверстие на трубе главного зеркала.
\end{enumerate}

После завершения сборки необходимо завершить получить изображение двух точечных источников. Изображение будет оцениваться программой, написанной на Octave в автоматическом режиме.

\subsubsection*{Юстировка}

После завершения сборки можно приступать к поиску изображения и юстировке. Перед юстировкой нужно убедиться что мениск сидит в трубе как можно центрированнее (т. е. его оптическая ось должна быть по возможности параллельна оси трубы). Это можно сделать только на глаз, и только довольно грубо, но, тем не менее, посмотрите как оно всё ориентировано - чтобы в мениске не было явного перекоса, или с одной стороны он не зашёл и т. д.

Нужно установить телескоп в тёмную комнату, включить источник света и  направить телескоп на источник. Первичное наведение можно сделать по тени телескопа. Когда телескоп наведён на источник, тень от трубы круглая, когда не наведён - эллиптическая. Сделайте тень от телескопа круглой и убедитесь, что в центре тени нет круглого светлого пятна. 

Дальше нужно попробовать поймать изображение в телескопе. Для этого нужно взять экран (лист белой бумаги) и поставить его за выходным отверстием. Лист надо размещать на таком же расстоянии, на котором в будущем будет находится камера. Если телескоп наведён, то на листке появится небольшое яркое пятно. Если оно не появляется, то нужно наводиться по мениску. Для наведения по мениску нужно аккуратно посмотреть на линзу телескопа со стороны источника света, не загораживая его. На линзе будет светлое пятно - отражение от главного (большого) зеркала попадает на линзу вместо вторичного (маленького) зеркала. Нужно подвигать телескоп или источник  чтобы светлое пятно на линзе попало на вторичное (маленькое) зеркало. После того как пятно попадёт на вторичное зеркало, будет видно что оно отражается от него. В идеале после отражения от вторичного зеркала свет попадает в отверстие главного зеркала. Если нет, этот свет будет виден по краям отверстия на главном зеркале, нужно подвигать телескоп чтобы он провалился.

После того как изображение попало на белый листочек, его нужно сфокусировать. Для этого нужно найти положение этого белого листочка при котором размер пятна минимален. Если изображение расфокусировано, то будет наблюдаться бублик - из-за того что в центре входного зрачка есть вторичное зеркало. Если изображение сфокусировано, то на листочке появятся тонкие детали источника. Можно поменять увеличение системы изменением положения мениска. Чтобы отодвинуть изображение от главного зеркала, нужно придвинуть мениск ближе к главному зеркалу. Чем дальше будет изображение от телескопа, тем больше увеличение.

Итак, после того как изображение поймано и сфокусировано, нужно вместо листа бумаги поставить камеру на то же самое место. Если быть совсем точным, нужно поставить именно кристалл приёмника веб-камеры в фокус, такой зеленоватый прямоугольничек с то место где находится изображение. Расстояние от этого приёмника до переднего края серебристой оправы вебкамеры составляет 2-3 см, нужно будет сфокусировать. Фокусировка производится движением камеры в хомуте (если его ослабить). Если размаха линейного переместителя не хватает для фокусировки, то нужно подвигать мениском, иными словами, грубая фокусировка производится передвижением мениска.

Если Вы собрали оптическую систему, то можно попробовать найти фокусное расстояние и получить чёткое изображение. Для этого необходимо:
\begin{itemize}
    \item подключить камеру к ПК или Raspberry;
    \item установить камеру на переместитель;
    \item вывести изображение на экран ПК; для этого можете воспользоваться любым ПО, способным работать с веб-камерой, например VLC.
\end{itemize}

\subsubsection*{СУПН}

Первоначально убедитесь в том, что Raspberry подключается к вашему ПК. 

После того, как мы научились подключаться к Raspberry пора попробовать получить данные с камеры. 
\begin{enumerate}
    \item Подключите камеру к Raspberry.
    \item Можно использовать motion для того, чтобы проверить, получает ли ПК данные от камеры. Как это сделать вы можете увидеть, например, здесь: \url{http://academicfox.com/raspberry-pi-usb-web-kamera-potokovoe-vydeo-strym/}
\end{enumerate}

Более подробно о функциях motion, а также о снимках (snapshots), можно прочитать здесь \url{https://motion-project.github.io/motion_config.html#snapshot_filename}

После получения потокового видео в конфигурациях motion необходимо:
\begin{itemize}
    \item задать разрешение $640 \times 480$
    \item убрать текстовые подписи с кадров
\end{itemize}

Вы можете использовать графический интерфейс или терминал для управления вашей Raspberry.

\subsubsection*{Проектирование группировки}

Разработка проекта созвездия в происходит в симуляторе «Орбита» и включает задачи:
\begin{enumerate}
    \item Осуществить обзорную съемку всей зоны интереса с наименьшем временным диапазоном и минимальной стоимостью группировки
    \item Осуществить съемку максимальной доли зоны интереса с наилучшим пространственном разрешением и минимальной стоимостью группировки
\end{enumerate}

Сегодня и завтра доступна первая задача: съёмка указанной зоны с низким разрешением мультиспектральной камеры. Вашей команде доступна задача по ссылке: \url{https://nti.orbitagame.ru/}

\assignementTitle{}{35}{}

Используя до 5 аппаратов, обеспечьте полное покрытие указанной зоны съемкой аппаратами с мультиспектральными камерами в ИК-диапазоне с ПР (пространственным разрешением) не хуже заданного.

Зона съемки: Область, ограниченная 68$^\circ$ и 78$^\circ$ северной широты, 32$^\circ$ и 74$^\circ$ восточной долготы, включающая в себя возможные маршруты судов между г. Мурманском и терминалом на м. Каменный (Обская губа).

Определение узлов зоны: Зона разбивается по широте с севера на юг на полосы шириной 10 км, остаток отбрасывается. Дальше каждая полоса разбивается по долготе с запада на восток на ячейки $10 \times 10$ км, остаток отбрасывается. Назовем “узлом” центр каждой такой ячейки. Узел считается снятым, если след аппарата в надире прошел от него не далее, чем на расстоянии половины ширины полосы съемки. “Вес” узла = $1/N$, где $N$ - количество узлов в зоне интереса.

Подзадачи:
\begin{itemize}
    \item Снять не менее одного раза в сутки указанную зону с ПР не более 4000 м
    \item Снять не менее одного раза в сутки указанную зону с ПР не более 500 м
    \item Снять не менее одного раза в сутки указанную зону с ПР не более 250 м
    \item Снять указанную зону от 2 до 6 раз в сутки с ПР не более 4000 м
    \item Снять указанную зону от 2 до 6 раз в сутки с ПР не более 500 м
    \item Снять указанную зону от 2 до 6 раз в сутки с ПР не более 250 м
\end{itemize}

Старт работы КА на орбите начинается с 01 июня 2019 года с 00:00 по UTC. Первые три часа пролёта не учитываются.

\markSection

\begin{itemize}
    \item Первая в сутки съемка узла с разрешением не более 4000 м: 1 балл $\times$ (вес узла)
    \item Первая в сутки съемка узла с разрешением не более 500 м: 3 балла $\times$ (вес узла)
    \item Первая в сутки съемка узла с разрешением не более 250 м: 6 баллов $\times$ (вес узла)
    \item Съемка узла от двух до шести раз в сутки с разрешением не более 4000 м: 2 балла $\times$ (вес узла).
    \item Каждая последующая съемка узла от двух до шести раз в сутки с разрешением не более 500 м: 2 балла $\times$ (вес узла).
    \item Каждая последующая съемка узла от двух до шести раз в сутки с разрешением не более 250 м: 2 балла $\times$ (вес узла).
\end{itemize}

\textit{Общие критерии оценки:}

\begin{itemize}
    \item Проход над точкой менее, чем через 60 минут после предыдущего, не засчитывается.
    \item При условной стоимости группировки S свыше 10 единиц результат домножается на коэффициент $10/S$.
    \item При снижении аппарата на высоту 300 км и менее балы перестают начисляться.
    \item Итоговая сумма баллов за задачу округляется до одного знака после запятой.
    \item Оценка за задачу равна сумме оценок за подзадачи.
\end{itemize}

Максимальное количество баллов: 40

Зона разбивается по широте с севера на юг на полосы 10 км, остаток отбрасывается. Дальше каждая полоса разбивается по долготе с запада на восток на ячейки $10 \times 10$ км, остаток отбрасывается. В центре каждой ячейки - узел. Процент покрытия зоны определяется как процент снятых узлов от их общего числа. Узел считается снятым, если след аппарата прошел от нее не далее, чем на расстоянии половины ширины полосы съемки. 

Параметры задачи:

\begin{table}[H]
    \center
    \begin{tabular}{|p{5cm}|p{10cm}|}
        \hline
        &Обзорная съемка \\
        \hline
        Зона интереса & Область, ограниченная 68$^\circ$ и 78$^\circ$ северной широты, 32$^\circ$ и 74$^\circ$  восточной долготы, включающая в себя возможные маршруты судов между г. Мурманском и терминалом на м. Каменный (Обская губа) \\
        \hline
        Шаг сетки в зоне интереса & 10 км \\
        \hline
        Требуемая частота съемки каждой точки в зоне интересов & Минимальная не менее 1 раза в сутки, рекомендуемая не менее 1 раза в 4 часа \\
        \hline
        Максимальное число аппаратов & 5 \\
        \hline
        Начало моделирования & 01.06.2019 00:00\footnote{Все время дано в часовом поясе (UTC+0)}     \\
        \hline
        Период начисления баллов & с 01.06.2019 03:00 включительно по 02.06.2019 03:00 не включительно (1 сутки). \\
        \hline
    \end{tabular}
\end{table}

Фактическая зона маршрутов танкеров:

\putImgWOCaption{12cm}{2}

\markSection

\begin{table}[H]
    \center
    \begin{tabular}{|p{10cm}|c|c|}
        \hline
        Задача	&Макс. балл	&Балл команды \\
        \hline
        \multicolumn{3}{|c|}{Спутник} \\
        \hline
        Сборка выполнена корректно, устройства в работоспособном состоянии	&5	& \\
        \hline
        Стабилизация: спутник в состоянии погасить начальную закрутку и продержаться в стабильном состоянии 40 секунд	&10	& \\
        \hline
        Ориентация: спутник способен повернуться на заданный угол и удерживать своё положение не менее 40 секунд&	15	& \\
        \hline
        \multicolumn{3}{|c|}{Оптика} \\
        \hline
        Осуществлена сборка оптической системы&	5	& \\
        \hline
        Проведена юстировка системы	&5&	 \\
        \hline
        С камеры выводится сфокусированное изображение&	10	& \\
        \hline
        \multicolumn{3}{|c|}{СУПН} \\
        \hline
        Raspberry подключается к ПК	&5	& \\
        \hline
        Raspberry получает видеопоток с камеры	&5	& \\
        \hline
    \end{tabular}
\end{table}

\subsubsection*{Интеграция оптики и СУПН}

Получите фото с Raspberry и передайте его на свой ПК.

Интеграция СУПН и спутника

Подключите Raspberry к бортовой сети спутника. Это можно сделать несколькими способами:
\begin{enumerate}
    \item Настройте обмен данными между Arduino и Raspberry. Например, можно использовать Serial, чтобы получать данные на Raspberry с Arduino. О том, как это можно сделать примерно описано здесь: \url{https://arduinoplus.ru/podkluchenie-raspberry-arduino/}
    
    Подключите к сети спутника Arduino, используя инструкцию: \url{http://www.orbicraft.sputnix.ru/doku.php?id=arduino_module_base_lesson}

    Далее, используя шилд, подсоедините через Arduino свою Raspberry к сети спутника.
    \item  Попробуйте напрямую подключить свою Raspberry к БКУ любым способом.
\end{enumerate}

\subsubsection*{Сохранение результатов}

Используя параметры входа зайдите в свое хранилище на сервере

Логин: RS№, где № - выданный вам порядковый номер.

Пароль: Password1

Адрес сервера в сети RS: 192.168.1.2

Под конец дня необходимо выгрузить на сервер:
\begin{itemize}
    \item фото собранного спутника
    \item фото собранной оптической системы
    \item фото с камеры с двумя источниками тока
    \item код стабилизации
    \item код ориентации
\end{itemize}

\markSection

\begin{table}[H]
    \center
    \begin{tabular}{|p{7cm}|c|c|}
        \hline
        Задача&	Макс. балл&	Балл команды \\
        \hline
        \multicolumn{3}{|c|}{СУПН} \\
        \hline
        Фото сохраняется на ваш ПК в автоматизированном режиме	&10	& \\
        \hline
        \multicolumn{3}{|c|}{Интеграция} \\
        \hline
        Настроен обмен данными между Raspberry и БКУ	&15	& \\
        \hline
    \end{tabular}
\end{table}

Если задачи выполнены, можно приступать к общему монтажу всей системы. Наиболее сложной частью является монтаж оптической системы к корпусу спутника.