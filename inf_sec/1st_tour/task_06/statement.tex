\assignementTitle{Silmarill Store 2}{}{}

Мы открыли новый интернет-магазин. Сможешь ли ты найти то, что мы прячем от посторонних глаз?

Ссылка на наш интернет-магазин: \url{http://silmarilstore.2018.cyberchallenge.ru/}.

Внимание! В этом интернет-магазине можно обнаружить целых два флага. Другой флаг надо сдавать в первую задачу.

\solutionSection

Данный сервис представляет из себя интернет магазин с двумя товарами. На счету пользователя изначально 100 единиц некоторой валюты. Самый дорогой предмет стоит 999999 единиц валюты, самый дешевый 1 единицу валюты. Путем логических рассуждений можно догадаться, что задача состоит в том, чтобы купить предмет на который не хватает денег.

Посмотрев код главной страницы сайта (как в задаче No Comments), или перехватив HTTP-запрос при покупке (например, с помощью утилиты Burp Suite: \url{https://portswigger.net/burp}), можно увидеть, что идентификаторы товаров (параметр id) являются порядковыми. Следовательно можно попробовать перебрать эти идентификаторы, на случай, если есть скрытые товары.

Чтобы понять как работает сервис, откроем консоль разработчика, нажав правой кнопкой мыши в любом месте на странице и выбрав пункт меню “Inspect”, и далее выбрав вкладку “Network”.

Нажав клавишу “Купить”, можно увидеть HTTP-запрос с методом POST на страницу. \url{http://silmarilstore.2018.cyberchallenge.ru/buy}.

\putImgWOCaption{10cm}{1st_tour/task_06/1}

С параметрами id и price.

\putImgWOCaption{10cm}{1st_tour/task_06/2}

Чтобы модифицировать запрос, воспользуемся утилитой Burp Suite (\url{https://portswigger.net/burp}). Инструкции по настройке можно найти на сайте. 

Перехваченный запрос на покупку может выглядеть так:

\putImgWOCaption{10cm}{1st_tour/task_06/3}

Для перебора значений параметра id воспользуемся утилитой Intruder, которая входит в состав BurpSuite. Для этого нужно нажать правой клавишей мыши и выбрать пункт меню “Send to Intruder”. Далее нужно выбрать вкладку “Positions” и оставить специальные символы только вокруг параметра id. Цену на всякий случай желательно установить равную 0.

\putImgWOCaption{10cm}{1st_tour/task_06/4}

Значения параметра для перебора можно задать на вкладке “Payloads”.  Тип параметра “Numbers”, а значения от 1 до 20 с шагом 1.

\putImgWOCaption{10cm}{1st_tour/task_06/5}

Запустить перебор можно клавишей Start Attack. Видно, что из всех значений параметра id, явно выделяются значения 1, 2 и 7. 

\putImgWOCaption{10cm}{1st_tour/task_06/6}

Если посмотреть результат покупки предмета со значением 7, там окажется флаг.

\putImgWOCaption{10cm}{1st_tour/task_06/7}

\answerMath{CC\{when\_in\_doubt\_follow\_your\_nose\}.}