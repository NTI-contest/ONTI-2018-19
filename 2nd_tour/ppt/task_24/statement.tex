\assignementTitle{Стенд с шаговым двигателем}{12}{}

\putImgWOCaption{10cm}{1}

Изготовить простейший стенд для демонстрации линейного перемещения на основе шагового двигателя. Стенд должен состоять из шагового двигателя, двух шкивов, зубчатого ремня, направляющих, каретки, концевого выключателя и миллиметровой линейки. На каретке (или непосредственно на ремне) должен быть предусмотрен маркер, четко показывающий текущую позицию.  Управление - от Arduino через драйвер шагового двигателя StepStick (на базе DRV8825, A4988 или аналогичных). Стенд должен демонстрировать: (а) калибровку - перемещение каретки в начальную позицию до замыкания концевого выключателя, при этом маркер должен находиться на нулевой позиции линейки, (б) В цикле, перемещение маркера к каждой из заданных точек, с кратковременной остановкой в каждой из этих точек.  Точки задаются до начала выполнения теста произвольно, вразброс, значения крупно и разборчиво записываются на листе бумаги и предъявляются на видео перед началом теста.  

Это задание на электронику и программирование, поэтому конструкция стенда не оценивается (за исключением ситуаций, когда ужасное качество конструкции не дает возможность провести тест или оценить его результаты). Вам необязательно конструировать такую сравнительно "навороченную" конструкцию, как на фото выше,  достаточно фанерки с закрепленным на ней двигателем и натяжным шкивом. Если данное задание и задание по конструированию выполняются командой одновременно, разрешается совместить их в одну конструкцию.

Рекомендуемый шаговый двигатель - любой NEMA 17 или NEMA 14.

Хотя в данном задании это не оговорено,  но реально действующее координатное устройство обычно может позиционироваться любое число раз на любые (в рабочем диапазоне) заданные координаты, в мм.  Поэтому в идеальном решении этого задания хочется видеть некую функцию, которая выполняет позиционирование, и эту функцию вы просто вызываете несколько раз в loop(), с задержками между вызовами.  Соответственно, баллы за решение задачи могут снижаться, если:

\begin{itemize}
    \item координаты в мм не задаются заранее, а получаются "какие получаются" \linebreak экспериментально, в результате поворота вала мотора на не-пойми-какие  углы
    \item логику программы пришлось бы сильно переделывать,  чтобы обеспечить позиционирование произвольное число раз на произвольные углы
    \item программа неэффективно написана  (есть очевидные улучшения, которые можно было бы применить, с существенным сокращением кода или улучшением читаемости/логичности)
    \item программа плохо отформатирована (хотя бы нажмите Ctrl-T, чтобы получить код "лесенкой", ставьте пустые строки между функциями, логически отдельными блоками определений переменных и т.п.)
\end{itemize}

Представляемые результаты:

\begin{itemize}
    \item Текст программы управления шаговым двигателем
    \item Видеозапись работы устройства.
\end{itemize}

\solutionSection

Это задание на электронику и программирование, поэтому конструкция стенда не оценивается (за исключением ситуаций, когда ужасное качество конструкции не дает возможность провести тест или оценить его результаты). Вам необязательно конструировать такую сравнительно "навороченную" конструкцию, как на фото выше,  достаточно фанерки с закрепленным на ней двигателем и натяжным шкивом. 

Если данное задание и задание по конструированию выполняются командой одновременно, разрешается совместить их в одну конструкцию. Большинство команд, прошедших во 2-й тур, так и поступили.  Отдельные стенды представили только несколько команд, участники которых работали удаленно или где мостовой кран не был вовремя изготовлен.

Обратите внимание,  что реально действующее координатное устройство обычно может позиционироваться любое число раз на любые (в рабочем диапазоне) заданные координаты.  Поэтому в идеальном решении этого задания хочется видеть некую функцию, которая выполняет позиционирование, и эту функцию вы просто вызываете несколько раз в loop(), с задержками между вызовами.  Соответственно, баллы за решение задачи могут снижаться, если:
\begin{itemize}
    \item координаты в мм не задаются заранее, а получаются "какие получаются" экспериментально, в результате поворота вала мотора на не-пойми-какие  углы
    \item логику программы пришлось бы сильно переделывать,  чтобы обеспечить позиционирование произвольное число раз на произвольные углы
    \item программа неэффективно написана  (есть очевидные улучшения, которые можно было бы применить, с существенным сокращением кода или улучшением читаемости/логичности)
    \item программа плохо отформатирована (хотя бы нажмите Ctrl-T, чтобы получить код "лесенкой", ставьте пустые строки между функциями, логически отдельными блоками определений переменных и т.п.)
\end{itemize}

Алгоритм калибровки:  в цикле двигаем каретку по 1 шагу в направлении к концевому выключателю.  По срабатыванию выключателя выходим из цикла и обнуляем переменную - счетчик позиции.

Алгоритм позиционирования:  В цикле сравниваем счетчик текущей позиции с заданной позицией. Если текущая позиция не равна заданной, делаем шаг в нужную сторону и соответственно изменяем на 1 текущую позицию. Когда текущая позиция выровнялась с заданной, выходим из цикла.

Полный код решения тривиален и здесь не приводится.