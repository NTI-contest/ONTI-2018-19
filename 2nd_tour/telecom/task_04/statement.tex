\assignementTitle{Передача информации по нескольким каналам связи}{22}{}

Необходимо принять с некоторого удаленного объекта сообщение длиной M единиц. Для этого важно понять хватит ли для этого наших возможностей. В нашем распоряжении 2 канала связи в каждом присутствует свой стационарный шум. Для анализа свойств шума в каждом канале была записана реализация шумового сигнала в $N = 1000$ отсчетов. Также известно, что вероятность передачи данных (полезного сигнала) с удаленного объекта составляет $50\%$, т.е. $50\%$ времени объект передает данные и $50\%$ времени «молчит». Амплитуда полезного сигнала не постоянна, но для каждого канала известно распределение вероятности его амплитуды. В качестве иллюстрации на рисунке приведены: верхний левый -- реализация шумового сигнала, нижний левый -- распределение вероятности амплитуды полезного сигнала, нижний правый -– пример реализации сигнала, соответствующий распределению на левом нижнем рисунке, правый верхний –- пример принятого сигнала $A_R$, представляющего сумму шума $A_N$ и полезного сигнала $A_S$:

$$A_R = A_N + A_S.$$

\putImgWOCaption{16.5cm}{1}

Верхний левый рисунок –- пример шумового сигнала, нижний левый рисунок~–- пример распределения вероятности амплитуды полезного сигнала, пример реализации сигнала, соответствующий распределению на левом нижнем рисунке, правый верхний –- пример принятого сигнала, представляющего сумму шума и полезного сигнала.

Из рисунка видно, что сигналы в каналах достаточно слабые, таким образом, рассматривается задача обнаружения сигнала (есть сигнал/нет сигнала). Решение о том, что в принятом сигнале присутствует полезный сигнал, принимается на основе сравнения амплитуды принятого сигнала с пороговым уровнем, если амплитуда больше или равна порогу, считаем, что полезный сигнал присутствует и отсутствует в противном случае. Пороговый уровень должен быть таким, чтобы сумма вероятности пропуска сигнала и вероятности ложных тревог (вероятность превышения шумом порога) была минимальной.

Если использование только одного из представленных каналов не позволяет решить задачу, тогда нужно задействовать несколько каналов. Для каждого канала известна потребляемая мощность. При использовании нескольких каналов суммируется и их энергопотребление.

Таким образом, необходимо проанализировать представленные шумовые сигналы и гистограммы распределения полезного сигнала, определить пороговый уровень и принять решение о том, какие каналы нужно задействовать, для приема сообщений длинной $M=50$ с наименьшими энергетическими затратами, так чтобы с вероятностью $99\%$ в сообщении было не более 2 ошибок.

\inputfmtSection

2 –- кол-во каналов;

50 –- длина передаваемого сообщения;

2 –- допустимое количество ошибок;

0.6 -- вероятность передачи данных (полезного сигнала);

4.0296 5.0000 –- 2 числа -- затраты энергии на передачу сигнала в каждом канале;

15 –- количество уровней сигнала;

0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 –- значения уровней сигнала;

Далее 2 строки -- Распределения уровня сигнала в каждом каналах (вероятность встретить сигнал с данным уровнем в данном канале, строка 1 –- распределение вероятности в 1 канале, 2-я строка –- распределение во втором канале)

1000 -- Длина шумовой реализации

Далее 2 строки -- Реализация шумового сигнала для каждого канала (строка 1 -- реализация, полученная в канале 1, строка 2 –- реализация, полученная в канале 2).


\outputfmtSection

1 –- необходимое кол-во каналов;

1 -- номера используемых каналов;

4 –- пороговый уровень для каждого из выбранных каналов;

0.996471 –- вероятность верного обнаружения единичного сигнала, при использовании всех выбранных каналов;

0.999239 -- Вероятность того что сообщение длины 50 будет получено с не более чем 2 ошибками;

5.000 -- Необходимая энергия для передачи единицы сообщения (суммарная энергия всех задействованных каналов)

\markSection

Максимальное число баллов - за полностью верный ответ, включающий:

\begin{itemize}
    \item Правильно определены номера каналов, использование которых позволит решить задачу с наименьшими энергетическими затратами; (3 балла)
    \item Правильно определены пороговые уровни выбранных каналов, перечисленных в пункте 1; (10 баллов)
    \item Правильно определена вероятность верного обнаружения единичного сигнала, при использовании всех выбранных каналов, перечисленных в пункте 1 (данную вероятность необходимо определить с точность до 4-го знака); (15 баллов)
    \item Правильно определена вероятность того, что с использованием выбранных каналов (пункт 1), сообщение длины M будет передано с не более чем 2 ошибками (данную вероятность необходимо определить с точность до 4-го знака); (5 баллов)
    \item Правильно рассчитана энергия, необходимая для передачи единицы сообщения (суммарная энергия всех задействованных каналов). (2 балла)
\end{itemize}

Штрафы:
\begin{itemize}
    \item В пункте (3):
    \begin{itemize}
        \item за ошибку в четвертом знаке снимается 5 баллов.
        \item за ошибку в третьем знаке снимается 15 баллов.
    \end{itemize}
    \item В пункте (4):
    \begin{itemize}
        \item за ошибку в четвертом знаке снимается 2 балла.
        \item за ошибку в третьем знаке снимается 5 баллов.
    \end{itemize}
\end{itemize}

Скорость выполнения программы~-- не более 10 секунд

Языки программирования -- Python, C, C++, Java.

Программа должна читать исходный файл со стандартного потока $stdin$ и передавать решение на стандартный поток $stdout$.


Проверка проводилась в несколько этапов(попыток), проводимых в заданную дату (20.12.2018; 29.12.2018; 06.01.2019; 11.01.2019; 14.01.2019). В каждой попытке участники могли загрузить и проверить одно свое решение этой задачи.
Результирующая оценка за задачу выбиралась, как максимальная из попыток.
Загрузка решений проводилась на сайте \url{http://dep1.iszf.irk.ru/wlcomm} на котором было установлено специальное программное обеспечение для регистрации, разделения доступа и возможности загрузки решений участниками.
Тестирование решений проводилось на виртуальной машине с установленной ОС Kubuntu, проверку и начисление баллов за каждый тест осуществляли автоматические программы.

\explanationSection

\begin{enumerate}
    \item Для каждого канала строим гистограмму распределения шума. Интеграл, полученной гистограммы нормируем на единицу. Полученное распределение обозначим $P_{Ni} (u)$, $I$ – номер канала $i \ni [1, 2]$.
    \item Для каждого канала на основе распределений сигнала и шума строим распределение “сигнал+шум” $P_{SNi} (u)=\int_0^uP_{Si}(v) P_{Ni}(u-v)dv$. В дальнейшем пороговый уровень будет определяться на основе $P_{Ni} (u)$ и $P_{SNi} (u).$
    \item Используем т. Байесса для того чтобы для каждого канала найти пороговый уровень $u_{bi}$, при котором минимизируется вероятность ложных тревог и вероятность пропуска.
    $$q_i+n_i \rightarrow min,$$
    
    $q_i=\int_0^{u_{bi}}P_{SNi}(u)du$ – вероятность пропуска сигнала,

    $p_i=1- q_i$ – вероятность верного определения сигнала в канале при данном пороговом уровне $u_{bi}$.
    
    $n_i=\int_{u_bi}^\infty P_{Ni}(u)du$ – вероятность ложной тревоги.

	\item Находим вероятность правильного принятия решения о наличии сигнала, на основе, найденного порогового уровня.
    
    Вероятность принятия правильного решения о наличии сигнала в канале:  $P_i=\frac{p \cdot p_i}{q \cdot n_i+p \cdot p_i }$, где $p$ – вероятность присутствия сигнала, $q =1-p$.
    \item Для каждого канала рассчитываем вероятность принятия сообщения из M отсчетов с не более чем двумя ошибками:
    $$P_{Mi}=P_i^M+C_M^1 P_i^{M-1} (1-P_i )+C_M^2 P_i^{M-2} (1-P_i)^2$$
    \item Если для одного канала вероятность принятия сообщения из M отсчетов с не более чем двумя ошибками удовлетворяет требованиям задачи, тогда решение задачи – использование данного канала. В случае, если оба канала удовлетворяют требованиям задачи, выбирается канал с наименьшими затратами энергии.
    \item Если ни один из каналов не удовлетворяет требованиям задачи, тогда возвращаем сообщение о том, что невозможно принять сообщение длинной М с не более чем двумя ошибками.
\end{enumerate}