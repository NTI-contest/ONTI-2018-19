Проверка на настоящее лицо человека
====

С задачи "Проверка на настоящее лицо человека" начинается практическое знакомство с сервисом Microsoft Face API.

Модели машинного обучения, реализованные с сервисе, позволяют упростить труд разработчика при программировании различных алгоритмов, работающих с изображениями лица человека.

Для решения задачи необходимо изучить API, который предоставляет сервис, и найти какой запрос нужно отправить к сервису для получения информации о повороте головы.

Сервис общается с внешними программами посредством индустриального стандарта REST, когда программа отправляет по HTTP протоколу запросы на удаленную систему, где запущен сервис.

Все доступные разработчику запросы описаны в документации по Microsoft Face API. Там же можно найти примеры для разных языков программирования.

Мы же поступим проще - будем использовать python библиотеку cognitive_face, которая скрывает все сложности, связанные с составлением и обработкой запросов.

Итак, согласно условию задачи нам предоставляется несколько десятков изображений. Давайте откроем одно из тех, где судя по ответу, представленному в задаче, есть наклон головы, и посмотрим так ли это.

```python
%matplotlib inline
import matplotlib.pyplot as plt
a = plt.imread("16.jpg")
plt.imshow(a)
```

То же самое сделаем с изображением, которое не вошло в ответ.

```python
plt.imshow(plt.imread("23.jpg"))
```

Действительно, в первом изображении голова человека наклонена влево. Зато во втором изображении очевидно заметен ее поворот.

Теперь попробуем отправить данные фотографии сервису Microsoft Face API и посмотреть его ответ для каждой из фотографий.

Поскольку сервис подразумевает обработку запросов только для авторизованных пользователей, то необходимо перед подключением к сервису указать авторизационный ключ.

Оставим получение этого ключа за рамками данного разбора. Скажем только, что сервис предоставляет ключи для ознакомительных целей.

Во время получения ключа также предоставляется URL для доступа к сервису. URL привязан географически к центру обработки данных, обеспечивая тем самым минимальные задрежки в работе.

Указав один раз данные параметры на этапе инициализации библиотеки cognitive_face, в остальной части программы про них можно забыть.

```python
import cognitive_face as CF

KEY = 'f5.........3c'
CF.Key.set(KEY)

BASE_URL = 'https://westeurope.api.cognitive.microsoft.com/face/v1.0'
CF.BaseUrl.set(BASE_URL)
```

Запрос detect к сервису позволяет определить лицо на изображении. Если при этом расширить запрос параметром headPose, то можно получить информацию о положении головы человека.

Распознаем лицо со второй фотографии с получением нужной нам информации.

<**При показе экрана с кодом. Голос за кадром**>В ответе от сервиса можно увидеть, что лицо человека наклонено почти на 4 градуса вправо и повернуто почти на 20 градусов влево.

```python
result = CF.face.detect('23.jpg', False, False, 'headPose')
print(result)
```

Направления лево и право отличаются знаком. Если число положительное, то зачит - наклон или поворот осуществлен влево. Если отрицательное - вправо.

Что определит сервис для первой фотографии?

<**При показе экрана с кодом. Голос за кадром**>В JSON ответе указано, что лицо наклонено на 18 градусов влево.

```python
result = CF.face.detect('16.jpg', False, False, 'headPose')
print(result)
```

По условию задачи известно, что пороговым значением для поворота и наклона является пятнадцать градусов.

Следовательно, простая проверка результатов работы сервиса позволит подойти к финальному решению.

```python
check = 'roll left'.split()
if check[0] == 'roll':
    val = result[0]['faceAttributes']['headPose']['roll']
elif check[0] == 'turn':
    val = result[0]['faceAttributes']['headPose']['yaw']

if check[1] == 'left':
    res = val > 15
elif check[0] == 'right':
    res = val < -15
print(res)
```

Запустив данную проверку для каждого изображения, полученного в качестве входных данных, можно найти ответ на задачу.