\assignementTitle{Обработка данных}{5}

Несмотря на относительную простоту SQL-запросов, вряд ли обычный бухгалтер, финансист или аналитик должны знать его, чтобы получать и обрабатывать данные, хранящиеся в реляционных базах данных. Огромное количество разработчиков программного обеспечения ежедневно работат на инструментарием, который бы позволял получать доступ к данным. Следовательно, нужно не только изучить непосредственно язык структурированных запросов, но и овладеть способами работы с базами данных из пользовательских приложений.

Одним из самых простых инструментов, позволяющих реализовать реляционную базу данных и обращаться к 
ней посредством SQL запросов, - это система управления базами данных (СУБД) SQLite (\url{https://ru.wikipedia.org/wiki/SQLite}). Все, что необходимо для использования SQLite в пользовательском приложении, - файл с данными и библиотека для соответствующего языка. Не нужно специально настраивать какой-то сервер базы данных, создавать на сервере разные базы для разных нужд - в SQLite базу данных создать также просто, как создать обычный файл.

Подержка SQLite есть для многих популярных языков программирования. Например, API для Python подробно опиcано здесь\\ 
\url{https://docs.python.org/3/library/sqlite3.html}.

Еще одним полезным навыком для специалиста работающего с данными является умение понять связь данных между 
собой в базах данных (особенно, подвергшихся нормализации высокого уровня \url{https://bit.ly/1pH8FGt}), где нет четкого описания или документации, какие таблицы и каким образом объединяют между собой данные. Поняв связь, из набора чисел можно извлечь полезные данные.

Представьте, у вас есть доступ к базе данных, и все что вы про нее знаете, что в ней есть информация о пользователях, магазинах, начальных балансах пользователей и транзакциях, описывающих траты пользователей в магазинах и переводы пользователей друг другу. Никакой другой документации, описывающей связи в базе данных не сохранилось.

Вам, как разработчику приложения для магазинов, необходимо написать модуль определения наличия скидки для покупателей. А именно, вашему модулю нужно ответить на вопрос: в скольких магазинах покупатель A будет получать скидки, если магазины, предоставляющие скидки требуют, чтобы на балансе покупателя в текущий момент было не меньше X условных денежных единиц, и покупатель до этого совершил не меньше Y покупок в конкретном магазине.

\inputfmtSection

В первой строке входных данных содержится имя покупателя A. Во второй строке - требования к балансу покупателя - количество необходимых денежных единиц X, заданное целым числом. Третья строка содержит требования по количеству покупок (Y) в каждом из искомых магазинов.

Последняя строка - ссылка на Google Drive, где необходимо скачать файл, описывающий базу данных в формате SQLite.

\outputfmtSection

В ответе необходимо предоставить только одно целое число - количество магазинов, где данный покупатель может получить скидки.

\begin{myverbbox}[\small]{\vinput} 
    customer71
    4945
    6
    https://drive.google.com/open?id=1s3kyPQrKxd9fIOIQpmGpoYIBQYcHtNgR
\end{myverbbox}
\begin{myverbbox}[\small]{\voutput}
    17
\end{myverbbox}
\inputoutputTable

%\includeSolutionIfExistsByPath{2nd_tour/fintex/task_06}