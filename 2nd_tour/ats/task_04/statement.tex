\assignementTitle{}{45}{}

Распознавание сигналов светофоров

В этом задании вы сможете использовать свои знания по компьютерному зрению для создания классификатора изображений светофора! Вам будут даны изображения светофора, на каждом из которых горит только один из трех сигналов: красный, желтый или зеленый.

Система классификации

Мы подготовили для вас программу на языке Python, в которой вы будете предварительно обрабатывать изображения, выделять особенности, которые помогут находить отличия в видах изображения, использовать эти особенности, чтобы разделить изображения по трём категориям: светофор с красным, желтым или зелёным сигналом.

Этапы работы:

\begin{enumerate}
    \item Загрузка и визуализация данных

    В любой задаче по классификации сначала необходимо ознакомиться с данными: Вам нужно будет загрузить изображения сигналов светофоров и визуализировать их!

    \item Предварительная обработка

    Входные изображения и выходные метки (labels) должны быть стандартизированы:, все входные данные должны быть одного типа и одного размера, а выходные данные должны быть числовой меткой. Так вы сможете проанализировать все входные изображения одним и тем же способом и предугадать, чего следует ожидать для нового изображения.

    \item Выделение особенностей

    Теперь необходимо выделить особенности в каждом изображении и классифицировать их. Поле для творчества безгранично: объекты могут быть как одномерными массивами (векторами), так и отдельными значениями, которые дают некую информацию об изображении, чтобы помочь вам классифицировать его как красный, желтый или зеленый сигнал светофора. 

    \putImgWOCaption{14cm}{1}

    \item Ошибки классификации и визуализации

    Наконец, вы создали функцию, которая использует найденные вами особенности для классификации любого сигнала светофора. Задача функции будет заключаться в том, чтобы получать на вход изображение и выводить метку (вектор из 3 значений). Вы можете сравнить прогнозируемую метку с истинной меткой и определить точность классифицируемой вами модели.

    \item Оцените свою модель

    Чтобы ваша работа была засчитана, классификатор должен иметь точность > 70\%. Вероятнее всего, вам нужно будет повысить точность вашего классификатора путем изменения имеющихся особенностей изображения или добавления новых. Чем выше точность, тем больше баллов вы получаете за решение.
\end{enumerate}

\solutionSection

Сформулируем задачу распознавания сигналов светофора. Мы имеем ряд изображений светофоров, на которых включён тот или иной сигнал. Нам следует определить, какой сигнал включён. Уточним, что это не изображение улицы, на котором где-то есть светофор – это светофор уже вырезанный из какого-то более общего кадра.

Следует отметить, что найти на изображении светофор и вырезать из этого изображения прямоугольную область, в которую этот светофор вписан, является самостоятельной задачей. Такая задача называется детектированием и предшествует распознаванию.

То есть, решая задачу распознавания, мы работаем с заранее детектированными и вырезанными изображениями светофоров. Как они были получены – отдельная тема, которую мы рассмотрим позже.

Итак, определяем какой сигнал включён на изображениях светофоров.

Самое интересное в нашем алгоритме то, что определяя цвет сигнала светофора, параметром "цвет" мы даже и не пользуемся. Зная, в какой области какой цвет расположен на светофоре, мы по яркости этой области определяем цвет. Причём на чёрно-белом изображении. Алгоритм такой:
\begin{itemize}
    \item приводим все изображения со светофорами к одному размеру;
    \item на каждом изображении отрезаем фон по краям, иногда даже с частью светофора;
    \item обрезанное изображение переводим в формат HSV;
    \item делаем HSV изображение одноканальным, оставив из трёх каналов один – яркость;
    \item считаем суммы значений яркости для трёх областей изображения: "красной", "жёлтой" и "зелёной";
    \item по максимальной сумме определяем в какой области включён сигнал.
\end{itemize}

Рассмотрим исходный текст программы.

\inputminted[fontsize=\footnotesize, linenos]{python}{2nd_tour/ats/task_04/source.py}

Запустив программу, Вы можете убедиться в том, что сумма яркости пикселей области с включённым сигналом значительно больше сумм двух других областей и алгоритм работает без ошибок.

Неудобство этой программы в том, что она работает с файлами изображений со специфическими именами. В реальной жизни приходится иметь дело с файлами, имеющими какие угодно имена, причём заранее, их знать, мы не можем и не должны.